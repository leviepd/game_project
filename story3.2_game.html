<!DOCTYPE html>
<html>

<body>

<div id=output>
Welcome Earthings.
</div>

Enter command: <input id=command onchange="got_input(this)">


<script>


write = function(s) {
	var h = document.getElementById("output").innerHTML; 
	document.getElementById("output").innerHTML = h + "<br>" + s;
}

/*var verb = {
	turn: "turn"
	go: "go",
	take: "take",
	use: "use",
	read: "read",
};
*/

block1 = {
	name: "Front Yard",
	disc: "It is a bright, sunny, summer day. There is a house to the north. The grass is sunbaked, and brown.",
	exits: {},
	items: {},
	things: {}
	
};

block2 = {
	name: "Front Porch",
	disc: "The porch is small and has a roof. There is a large oak door to the north... There is a bench to the left.",
	exits: {},
	items: {},
	things: {},
};

block3 = {
	name: "Right side of House",
	disc: "",
	exits: {},
	items: {},
	things: {}
};

block4 = {
	name: "Left side of House.",
	disc: "",
	exits: {},
	items: {},
	things: {}
};

block5 = {
	name: "Mailbox",
	disc: "The mailbox appears to be wide open.",
	disc2: "Labyrinth is a game of adventure. Beware of any danger out there. Happy Exploring.",
	exits: {},
	items: {},
	things: {}
};

block6 = {
	name: "Front Door ",
	disc: "What a beautifuly crafted door... with two knobs???",
	exits: {},
	items: {},
	things: {}
};

block8 = {
	name: "Bottom of a Pit",
	disc: "A trap door opens. You fall straight down onto long, rusty lengths of re-bar. The rebar impales your body. You bleed out and DIE!",
	end: true,
	exits: {},
	items: {},
	things: {}
};

block9 = {
	name: "Entry Way",
	disc: "What a cozy little house. The entry way is extremely small. To the east is a living room. North leads down a narrow hallway that goes to the end of the house. There is a staircase directly to the west that leads upwards... what a strange place for a staircase...",
	exits: {},
	items: {},
	things: {}
};

block7 = {
	name: "Bench",
	disc: "A 6 ton weight falls and crushes you... Really? You just had sit on the fucking bench.",
	end: true,
	exits: {},
	items: {},
	things: {}
};

block10 = {
	name: "Living Room",
	disc: "All the surrounding walls are covered in bookshelves. In the center of the room there is a chair, and a small table. The table is covered in all kinds of interesting trinkets.",
	exits: {},
	items: {},
	things: {}
};

block11 = {
	name: "Narrow Hallway",
	disc: "You make your way down the hallway. Ten paces down you trip over a rug, and crack your head open on the hardwood floor...",
	end: true,
	exits: {},
	items: {},
	things: {}
};

block12 = {
	name: "Upstairs hallway",
	disc: "At the top of the stairs you find yourself facing another long narrow hallway. To the east is a door that has a piece of paper taped to it. To the west is another door.",
	disc2: "Beware, this is no place for wonderers.",
	exits: {},
	items: {},
	things: {}
};

block13 = {
	name: "Bedroom",
	disc: "This room appears to belong the a young teenager. The walls are littered with ameture looking sketches of demonic creatures. wtf, the more you look, the freakier they become. There are dirty dishes all over the floor. Across the room is a door that could go to a closet. In the middle of the room there is a bed... blankets covered in red blood stains. ",
	exits: {},
	items: {},
	things: {}
};

block14 = {
	name: "Closet",
	disc: "Inside the closet you find a staircase that leads down into blackness... You would need some light to go down there. There may be a light switch around here somewhere.",
	disc2: "You are to afraid to go down... need more light.",
	exits: {},
	items: {},
	things: {}
};

block15 = {
	name: "Basement",
	disc: "The basement is a cold, damp place... You hear water droplets echo almost as if you are in a cavern. The basement is empty besides the piece of paper lying on the floor. There is no aparrent direction you can go besides back up the stairs.",
	exits: {},
	items: {}
};

leaflet = {
	take: true,
	readable: true,
	disc: "Labyrinth is game of adventure. Beware of any danger out there. Happy Exploring.  - Maker"
};

note = {
	take: true,
	readable: true,
	disc: "Beware, this is no place for wonderers"
};

bat = {
	take: true,
	readable: false,
};

key = {
	take: true,
	readable: false
};

lantern = {
	take: true,
	readable: false,
	disc: "kjahdfkjadflkjakdjfas",
	lantern_use: false
};
knife = {
	take: true,
	readable: false
};

bottle = {
	take: true,
	readable: false
};

apple = {
	take: true,
	readable: false
};

lswitch = {
	take: false,
	readable: false,
	disc: "The stiarcase is dimly lit... you still can not see the bottom... need more light."
};

// Game Data

block1.exits.north = block2;
block1.exits.south = block5;
block1.exits.east = block3;
block1.exits.west = block4;
block2.exits.south = block1;
block2.exits.north = block6;
block2.exits.bench = block7;
block2.items.bat = bat;
block2.items.key = key;
block3.exits.west = block1;
block4.exits.east = block1;
block5.items.leaflet = leaflet;
block5.exits.north = block1;
block6.exits.rightknob = block8;
block6.exits.leftknob = block9;
block6.exits.south = block2;
block9.exits.south = block2;
block9.exits.east = block10;
block9.exits.upstairs = block12;
block9.exits.north = block11;
block10.exits.west = block9;
block10.items.apple = apple;
block10.items.knife = knife;
block10.items.bottle = bottle;
block10.items.lantern = lantern;
block12.exits.downstairs = block9;
block12.items.note = note;
block12.exits.west = block13;
block13.exits.east = block12;
block13.exits.north = block14;
block14.exits.south = block13;
block14.items.lantern = lantern;
block14.exits.downstairs = block15;
block14.items.switch = lswitch;

gameOver = false

current = block1;

// handles changes to input element in html page
var got_input = function(element) {
	handle_input(element.value);  // calls handle_input and argues a string
	element.value = "";  
	element.scrollIntoView();  
}

function situation() {
	
	write("");
	write("Location: " + current.name);
	write(current.disc);

	// make a string out of the available exits
	var a = [];   
	for(var k in current.exits) {
		a.push(k);   // pushes k into the array
	}
	var x = a.join(", ");  // x = "north, south"
	write("Go: "+x);


	// make a string out of the available objects
	var a2 = [];
	for(var j in current.items) {
		a2.push(j);
	}
	var y = a2.join(", ");
	write("Objects In View: "+y);
	
	var a3 = [];
	for(var l in inventory) {
		a3.push(l);
	}
	var z = a3.join(", ");
	write("Pack: " +z);

}

inventory = {};

/*var notes = {
	leaflet: "Labyrinth is a game of adventure. Beware of any danger out there. Happy Exploring.  - Maker",
	note: "Beware, this is no place for wonderers."
};
*/

var test = false;

situation();

handle_input = function(act) {

	if(gameOver) {
		write("Sorry, game over.");
		return;
	}

	act = act.toLowerCase();
	act = act.split(" ");     // act is ["", ""]
	var verb = act[0];												
	var ood = act[1];	     // act = ["verb", "item"]    
	// oob object or direction
	if(verb === "go") { 
		// User wants to go somewhere
		if(current.exits[ood]) {
			// the exit requested does exist
			if(current.exits[ood] === block15) {  // the place they want to go block15
				if(lantern.lantern_use === false) {  // is the lantern lit
					write(block14.disc2);
				}
			}
			if(current.end === true) {
				gameOver = true;
			}
			current = current.exits[ood];
		}
			else {
				write("can't go that way.");
			}
	}
	else 
	if(verb === "take") {
		if(current.items[ood]) {
			var thing = current.items[ood]; //points at items in block, but not item objects that have the take property...
				if(thing.take === true) {
					inventory[ood] = thing;
					delete current.items[ood];
					situation();
				}	

				else {
					write("You can not take that.");
				}
		}
	}
		//	var thing = current.items[ood]   // current.items[ood] = inventory[ood];
		//	inventory[ood] = thing;
		
/*	else // use bat
	if(verb === "use") {
		// user wants to use something
		
		if(inventory) {
			// i am carrying that thing			
			if(current.name === "Entry Way") {
				write(current.disc2);
				gameOver = true;
			}
		}
		else {
			write("You do not have that item.");
		}
	}
*/	
	else 
	if(verb === "use") {
			var thing = inventory[ood];
				if(thing == lantern) {
					write(thing.disc);
					lantern.lantern_use = true;
				}
				else 
				if(thing !== lantern && thing !== undefined) {
					write("You can not use that item here.");
				}
				else	
				if(thing === undefined) {
					write("You don't have that item.");
				}
	}
else
if(lantern_use === true) {
	if(verb === "go") {
		if(current.exits.downstairs) {
			current = current.exits.downstairs;
			situation();
		}		
	}
}
	else
	if(verb === "read") {
		var thing = inventory[ood];
		if(thing === undefined) {
			write("You can not read that.");
		}
		else
		if(thing.readable === true) {
			write(thing.disc);
	}
	}
	else
	if(verb === "sit") {
		if(current.exits[ood]) {
			current = current.exits[ood]
			if(current.end) {
				gameOver = true;
			}
			situation();
		}
	}
	else
	if(verb === "flip") {
		if(current.items[ood]) {
			write(lswitch.disc);
		}
	}
/*	else 
	if(verb === "turn") {
		if(current.things[ood]) {
			current = curruent.things[ood]
		}
	}  
	*/
	else {
		write("That is not an option.");
	}
};
	


/*

	if(act === "bat" && pack === "") {  //prompt "usebat" && pack;
		write("you don't have a bat");
	}
//	else
	if (act === "bat" && pack !== "") { // prompt "usebat" && pack === current.things[act];  ... pack is defined
		// gameover
		write(current.disc2);
		return;
	}
//	else
	if(act === "sit") {
		// gameover
		write(current.disc2);
		return;
	}
/*	else  {
		if(current.exits[act]) {  //current.action.exits[act] ???
			current = current.exits[act]   // the current location is whatever was promped
		
			if(current.end) {    // if current.end is true then gameOver is also true --- ends the game
				gameOver = true;
			}
		}
		else
		if(current.items[act]) {   // the current item is whatever was prompted
			pack = current.items[act];  // the item is the pack...
			delete current.items[act];
		} 
		else {
			write("can't go that way...");  // only if !== current.exits[act]
		}
	}


	situation();
*/



</script>

</body>

</html>
