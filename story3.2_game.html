<!DOCTYPE html>
<html>

<body>

<div id=output>
Welcome.
</div>

Enter command: <input id=command onchange="got_input(this)">


<script>


write = function(s) {
	var h = document.getElementById("output").innerHTML; 
	document.getElementById("output").innerHTML = h + "<br>" + s;
}

/*var verb = {
	turn: "turn"
	go: "go",
	take: "take",
	use: "use"
};
*/

block1 = {
	name: "Front Yard",
	disc: "It is a bright, sunny, summer day. There is a house to the north. The grass is sunbaked, and brown.",
	exits: {},
	items: {}
	
};

block2 = {
	name: "Front Porch",
	disc: "The porch is small and has a roof. There is a large oak door to the north... There is a bench to the left. On top of the bench is a baseball bat.",
	exits: {},
	items: {}
};

block3 = {
	name: "Front Door ",
	disc: "What a beautifuly crafted door... with two knobs???",
	exits: {},
	items: {}
};

block4 = {
	name: "Bottom of a Pit",
	disc: "A trap door opens. You fall straight down onto long, rusty lengths of dull rebar. The rebar pentrates your body. You bleed out and DIE!",
	end: true,
	exits: {},
	items: {}
};

block5 = {
	name: "Inside",
	disc: "The house is quite nice... too nice... you have a sudden urg to break everything in sight.",
	disc2: "You crush everything in sight. Congrats you win!",
	exits: {},
	items: {}
};

block6 = {
	name:"Bench",
	disc: "A 6 ton weight falls and crushes you.",
	end: true,
	exits: {},
	items: {}
};

block1.exits.north = block2;
block2.exits.south = block1;
block2.exits.north = block3;
block2.exits.sit = block6;
block2.items.bat = block2;
block3.exits.rightknob = block4;
block3.exits.leftknob = block5;
// block5.exits.break = block5;
// block5.items.usebat = block5;
block5.exits.south = block2;

gameOver = false

current = block1;



// handles changes to input element in html page
var got_input = function(element) {
	handle_input(element.value);  // calls handle_input and argues a string
	element.value = "";  
	element.scrollIntoView;  
}

function situation() {
	
	write("");
	write("You are here: " + current.name);
	write(current.disc);

	// make a string out of the available exits
	var a = [];   
	for(var k in current.exits) {
		a.push(k);   // pushes k into the array
	}
	var x = a.join(", ");  // x = "north, south"
	write("Places you can go: "+x);


	// make a string out of the available objects
	var a2 = [];
	for(var j in current.items) {
		a2.push(j);
	}
	var y = a2.join(", ");
	write("Things you see: "+y);
	pack();
}

pack = function() {
	var a3 = [];
	for(var l in inventory) {
		a3.push(l);
	}
	var z = a3.join(", ");
	write("Things you have: "+z);
}

inventory = {};

situation();

handle_input = function(act) {

	if(gameOver) {
		write("Sorry, game over.");
		return;
	}

	act = act.toLowerCase();
	act = act.split(" ");     // act is ["", ""]
	var verb = act[0];	
	var ood = act[1];	     // act = ["verb", "object"]
	// oob object or direction
	if(verb === "go"){
		// User wants to go somewhere
		if(current.exits[ood]) {
			// the exit requested does exist
			current = current.exits[ood]			// actually go there
			if(current.end === true) {
				gameOver = true;
			}
			situation();
	
	} 
		else {
			write("can't go that way");
		}
	}
	else 
	if(verb === "take") {
		if(current.items[ood]) {
			var thing = current.items[ood]   // current.items[ood] = inventory[ood];
			inventory[ood] = thing;
			delete current.items[ood];
			situation();
		
		}
		else {
			write("you can't take that.");
		}
	}
	else 
	if (verb === "use") {
		// user wants to use something
		if(inventory) {
			// i am carrying that thing
			if(current.name === "Inside") {
				write(current.disc2);
				gameOver = true;
			}
			situation();
		
		}
		else {
			write("You do not have that item.");
		}
	}
	else {
		write("That was not an option.");
	}

	


/*

	if(act === "bat" && pack === "") {  //prompt "usebat" && pack;
		write("you don't have a bat");
	}
//	else
	if (act === "bat" && pack !== "") { // prompt "usebat" && pack === current.things[act];  ... pack is defined
		// gameover
		write(current.disc2);
		return;
	}
//	else
	if(act === "sit") {
		// gameover
		write(current.disc2);
		return;
	}
/*	else  {
		if(current.exits[act]) {  //current.action.exits[act] ???
			current = current.exits[act]   // the current location is whatever was promped
		
			if(current.end) {    // if current.end is true then gameOver is also true --- ends the game
				gameOver = true;
			}
		}
		else
		if(current.items[act]) {   // the current item is whatever was prompted
			pack = current.items[act];  // the item is the pack...
			delete current.items[act];
		} 
		else {
			write("can't go that way...");  // only if !== current.exits[act]
		}
	}


	situation();
*/

}

</script>

</body>

</html>
