<!DOCTYPE html>
<html>

<body>

<div id=output>
Welcome.
</div>

Enter command: <input id=command onchange="got_input(this)">


<script>


write = function(s) {
	var h = document.getElementById("output").innerHTML; 
	document.getElementById("output").innerHTML = h + "<br>" + s;
}



block1 = {
	name: "Front Yard",
	disc: "It is a bright, sunny, summer day. There is a house to the north. The grass is sunbaked, and brown.",
	exits: {},
	things: {}
};

block2 = {
	name: "Front Porch",
	disc: "The porch is small and has a roof. There is a large oak door to the north... There is a bench to the left. On top of the bench is a baseball bat.",
	disc2: "A 6 ton weight crushes your body",
	exits: {},
	things: {}
};

block3 = {
	name: "Front Door ",
	disc: "What a beautifuly crafted door... with two knobs???",
	exits: {},
	things: {}
};

block4 = {
	name: "Bottom of a Pit",
	disc: "A trap door opens. You fall straight down onto long, rusty lengths of dull rebar. The rebar pentrates your body. You bleed out and DIE!",
	end: true,
	exits: {},
	things: {}
};

block5 = {
	name: "Inside",
	disc: "The house is quite nice... too nice... you have a sudden urg to break everything in sight.",
	disc2: "You crush everything in sight. Congrats you win!",
	exits: {},
	things: {}
};

block1.exits.north = block2;
block2.exits.south = block1;
block2.exits.north = block3;
block2.exits.sit = block2;
block2.things.bat = "A bat";
block3.exits.rightknob = block4;
block3.exits.leftknob = block5;
// block5.exits.break = block5;
//block5.things.usebat = block5;
block5.exits.south = block2;

gameOver = false

current = block1;

var pack = "";


// handles changes to input element in html page
got_input = function(element) {
	handle_input(element.value);
	element.value = "";
	element.scrollIntoView();
}


function situation() {
	write("You are here: " + current.name);
    write(current.disc);	 // describes the block

	// make a string out of the available exits
	var a = [];   
	for(var k in current.exits) {
		a.push(k);   // pushes k into the array
	}
	var x = a.join(", ");  // x = "north, south"
	write("Places you can go: "+x);


	// make a string out of the available objects
	var a2 = [];
	for(var j in current.things) {
		a2.push(j);
	}
	var y = a2.join(", ");
	write("Things you see: "+y);

	write("Things you have: "+pack);
}



situation();

handle_input = function(act) {

	act = act.toLowerCase();


	if(gameOver) {
		write("Sorry, game over.");
		return;
	};    // if true then break


	if(act === "usebat" && pack === "") {  //prompt "usebat" && pack;
		write("you don't have a bat");
	}
	else if (act === "usebat" && pack !== "") { // prompt "usebat" && pack === current.things[act];  ... pack is defined
		// gameover
		write(current.disc2);
		return;
	}
	else
	if(act === "sit") {
		// gameover
		write(current.disc2);
		return;
	}
	else  {
		if(current.exits[act]) {  
			current = current.exits[act]   // the current location is whatever was promped
		
			if(current.end) {    // if current.end is true then gameOver is also true --- ends the game
				gameOver = true;
			}
		}
		else
		if(current.things[act]) {   // the current thing is whatever was prompted
			pack = current.things[act];  // the thing is the pack...
			delete current.things[act];
		} 
		else {
			write("can't go that way...");  // only if !== current.exits[act]
		}
	}


	situation();

}



</script>

</body>

</html>
